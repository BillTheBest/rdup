0/ BACKUPS WITH RDUP

1 local mirroring backups
2 remote mirroring backups 
3 External HD backups         (doc todo, code is there)

1/ HOW TO MAKE BACKUPS

1. What directories do you want to backup?
   (Let's say: /home)
2. Where do you want to store the backups?
   (Let's say: /vol/backup/`hostname`)

There is no default directory where your backups will
be places. I use a setup where each backup will be
places under a YYYYMM directory. Dump.sh will only
add that suffix.

1.1/ LOCAL FULL DUMP

As root run:
rm -f /etc/rdup/HOME_TIMESTAMP /etc/rdup/HOMELIST && \
/usr/bin/rdup -N /etc/rdup/HOME_TIMESTAMP /etc/rdup/HOMELIST /home |\
/usr/sbin/rdup-mirror -b /vol/backup/$HOSTNAME/`date +%Y%m`

When this completes it will print (or something very simular):
** #REG FILES  : 32
** #DIRECTORIES: 2521
** #LINKS      : 0
** #(RE)MOVED  : 2
** SIZE        : 139305 KB
** STORED IN   : /vol/backup/elektron/200601
** ELAPSED     : 42 s

The TIMESTAMP file is used to calculate when the last backup took
place. In HOMELIST rdup keeps track of what files are backed up. This
is needed to calculate which files are removed when an incremental
dump is started.

1.2/ LOCAL INCREMENTAL DUMP

An incremental dump is easy, just run:
/usr/bin/rdup -N /etc/rdup/HOME_TIMESTAMP /etc/rdup/HOMELIST /home |\
/usr/sbin/rdup-mirror -b /vol/backup/$HOSTNAME/`date +%Y%m`

This will dump all files that have changed sine the last dump. The time
of the last dump is gotten from the file HOME_TIMESTAMP. Old files in
the backup filesystem are moved to: filename+MONTHDAY.HH.MM and the new
files are put in place.

Incremental backups can be run as often as you want. The tools
yesterday.sh and hist.sh can be used to retrieve old files.

2/ REMOTE BACKUPS

In both examples the backup will be placed in /vol/backup.

rdup -c -N timestamp HOMELIST ~ | ssh user@otherhost rdup-mirror -c \
-b backupdir/

or if you want bandwidth limitation:

rdup -c -N timestamp HOMELIST ~ | cstream | ssh user@otherhost \ 
rdup-mirror -c -b backupdir

3/ EXTERNAL HARDDISK BACKUPS
In the sh-wrapper/ directory there is a script dump-here.sh which you
can use for that. It will create the backup in the directory it is
called from.
