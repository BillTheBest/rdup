
# source this file to get some commonly
# used functions in the rdup-utils.

# show the version of the tool
version() {
        echo "$PROGNAME: @PACKAGE_VERSION@ (rdup-utils)"
}

cleanup() {
        _echo2 "Signal received while processing \`$path', exiting"
        if [[ ! -z $TMPDIR ]]; then
                rm -rf $TMPDIR
        fi
        exit 1
}

# echo to standard error
_echo2() {
        echo "** $PROGNAME: $1" >&2
}

what() {
        BACKUPDIR=$1
        NOW=$2
        if [[ -d $BACKUPDIR/$NOW ]]; then
                # already there do not link
                return 0
        fi

        for i in `seq 1 7`; do
                dir=`date +%Y%m/%d --date "$i days ago"`
                if [[ -d $BACKUPDIR/$dir ]]; then
                        # copy 'em over
                        _echo2 "Linking dir: \`$BACKUPDIR/$dir'"
                        cp -plr $BACKUPDIR/$dir $BACKUPDIR/$NOW
                        return 0
                fi
        done
        return 1
}
